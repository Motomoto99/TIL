# スコープについてまとめてみた

## 目次
- 関数スコープ・ブロックスコープ
- グローバルスコープ・スクリプトスコープ・モジュールスコープ
- レキシカルスコープ
- スコープチェーン
- クロージャ

## 関数スコープ・ブロックスコープ
関数宣言内が変数や関数の使用できる範囲のこと.  
if文やfor文のブロック{}が変数や関数の使用できる範囲のこと。  
```
function fn(){
    let val = "関数スコープ";
    const dis = function(){ console.log("関数スコープ); };
    console.log(val); //実行可能
    dis(); //実行可能
}
if(true){
    let val2 = "ブロックスコープ";
    const dis2 = function(){ console.log("関数スコープ); };
    console.log(val2); //実行可能
    dis2(); //実行可能
    console.log(val); //エラー
    dis(); //エラー
}
console.log(val,val); //エラー
dis(); //エラー
dis2(); //エラー
```
この宣言内やブロックの外から変数や関数を参照することができない

## グローバルスコープ・スクリプトスコープ・モジュールスコープ
### グローバルスコープ
javascriptファイルのトップレベルまたは、HTMLファイルのscriptタグの直下に記述したコード内で、  
「varを使って定義した変数や関数」または「関数宣言によって定義された関数」が属する範囲のこと。  
```
<script>
    var globalVal = "グローバル変数";
    function globalFn(){return "グローバル関数";};

    function callGlobals() {
        console.log(globalVal,globalFn() );　//関数内から関数スコープより外に参照できる
    }
    callGlobals();
    ⇒グローバル変数 グローバル関数
</script>
<script>
    console.log(globalVal,GlobalFn()); //異なるscriptから参照可能
    ⇒グローバル変数 グローバル関数
</script>
```
グローバルスコープに配置された変数や関数は、コードのどこからでも参照することができるようになる。　　
varや関数宣言を使って定義した変数や関数はwindowオブジェクトのプロパティやメソッドとして格納される　　
`console.log(window.globalVal);`　　


### スクリプトスコープ
javascriptファイルのトップレベルまたは、HTMLファイルのscriptタグの直下に記述したコード内で、  
「letやconstを使って定義した変数や関数」が属する範囲のこと。
```
<script>
    let scriptVal = "スクリプトスコープ変数";
    const scriptFn = function(){ return "スクリプトスコープ関数"; };
</script>
<script>
    console.log(scriptVal,scriptFn());
    ⇒スクリプトスコープ変数　スクリプトスコープ関数
</script>
```
基本的にはグローバルスコープと区別することないが、windowオブジェクトにプロパティとして格納されない。

### モジュールスコープ
ES Modulesっていう機能を有効にすることでつかるらしい。
```
<script type="module">
    let moduleVal = "モジュールスコープ変数";
    console.log(moduleVal);
    ⇒モジュールスコープ変数
</script>
<script type="module">
    console.log(moduleVal);  //エラーが発生する、異なるscriptタグから参照ができないようになる
</script>
```

## レキシカルスコープ
これはJavaとかでも同じ感じで、ブロックスコープとかの中の実行文で外で宣言している変数や関数を使っていいよってやつ。  
スコープの外にある関数の中で宣言している変数や関数は使えない。

## スコープチェーン
一致する変数を段階的にスコープの外に探しに行く感じの挙動って感じかな。  
同じスコープ内に指定した変数や関数がなかったら一つ外側のスコープを探す。  
そこにもなかったらさらに一つ外側のスコープに探しに行く。最終的にグローバルスコープまで探しに行ける。  
同じところに同じ名前があった場合、varや関数宣言したやつとconstやletで宣言したやつで比較したら、letやconstはスクリプトスコープでグローバルスコープより一つ内側だからそっちが優先される。

## クロージャ
ちょっと難しいけど、引数として渡した値を保持し続けることらしい。  
一つの関数宣言をしたやつを使って動的に新しい関数を作れったりできる。なんかインスタンス的な感じ親クラスに引数を渡してそれ使わせて新しい子クラス作るみたいな感じがした。  
もっと詳しくやってみてもいいかも
